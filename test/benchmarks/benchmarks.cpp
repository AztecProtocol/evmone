// evmone: Fast Ethereum Virtual Machine implementation
// Copyright 2019 Pawel Bylica.
// Licensed under the Apache License, Version 2.0.

#include <evmone/evmone.h>

#include <evmc/helpers.hpp>
#include <evmc/instructions.h>
#include <benchmark/benchmark.h>
#include <intx/intx.hpp>
#include <iomanip>
#include <iostream>
#include <sstream>

#include "../unittests/utils.hpp"

using namespace benchmark;

namespace
{

    using namespace std::literals;

extern evmc_host_interface interface;

int num_repetitions = 10;
// FIXME: Allow running with empty code.
// clang-format off
const auto empty_code = from_hex("00");
const auto sha1_divs_code = from_hex("608060405234801561001057600080fd5b5060043610610047577c010000000000000000000000000000000000000000000000000000000060003504631605782b811461004c575b600080fd5b6100f26004803603602081101561006257600080fd5b81019060208101813564010000000081111561007d57600080fd5b82018360208201111561008f57600080fd5b803590602001918460018302840111640100000000831117156100b157600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600092019190915250929550610127945050505050565b604080517fffffffffffffffffffffffffffffffffffffffff0000000000000000000000009092168252519081900360200190f35b60006040518251602084019350604067ffffffffffffffc0600183011601600982820310600181146101585761015f565b6040820191505b50776745230100efcdab890098badcfe001032547600c3d2e1f06101d0565b6000838310156101c9575080820151928290039260208410156101c9577fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff60208590036101000a0119165b9392505050565b60005b82811015610686576101e684828961017e565b85526101f684602083018961017e565b60208601526040818503106001811461020e57610217565b60808286038701535b506040830381146001811461022b57610239565b602086018051600887021790525b5060405b6080811015610339578581017fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc08101517fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc88201517fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffe08301517ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff48401516002911891909218189081027ffffffffefffffffefffffffefffffffefffffffefffffffefffffffefffffffe1663800000009091047c010000000100000001000000010000000100000001000000010000000116179052600c0161023d565b5060805b61014081101561043a578581017fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff808101517fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff908201517fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc08301517fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffe88401516004911891909218189081027ffffffffcfffffffcfffffffcfffffffcfffffffcfffffffcfffffffcfffffffc1663400000009091047c03000000030000000300000003000000030000000300000003000000031617905260180161033d565b508160008060005b605081101561065c5760148104801561047257600181146104ae57600281146104e857600381146105275761055d565b6501000000000085046a0100000000000000000000860481186f01000000000000000000000000000000870416189350635a827999925061055d565b6501000000000085046f0100000000000000000000000000000086046a0100000000000000000000870418189350636ed9eba1925061055d565b6a010000000000000000000085046f010000000000000000000000000000008604818117650100000000008804169116179350638f1bbcdc925061055d565b6501000000000085046f0100000000000000000000000000000086046a010000000000000000000087041818935063ca62c1d692505b50601f770800000000000000000000000000000000000000000000008504168063ffffffe073080000000000000000000000000000000000000087041617905080840190508063ffffffff86160190508083019050807c0100000000000000000000000000000000000000000000000000000000600484028c0151040190507401000000000000000000000000000000000000000081026501000000000086041794506a0100000000000000000000633fffffff6a040000000000000000000087041663c00000006604000000000000880416170277ffffffff00ffffffff000000000000ffffffff00ffffffff861617945050600181019050610442565b5050509190910177ffffffff00ffffffff00ffffffff00ffffffff00ffffffff16906040016101d3565b506c0100000000000000000000000063ffffffff821667ffffffff000000006101008404166bffffffff0000000000000000620100008504166fffffffff000000000000000000000000630100000086041673ffffffff00000000000000000000000000000000640100000000870416171717170294505050505091905056fea165627a7a7230582083396642a98f6018c81ca24dc0c2af8e842bd33a6b8d7f08632dc1bc372e466a0029");
const auto sha1_shifts_code = from_hex("608060405234801561001057600080fd5b506004361061002b5760003560e01c80631605782b14610030575b600080fd5b6100d66004803603602081101561004657600080fd5b81019060208101813564010000000081111561006157600080fd5b82018360208201111561007357600080fd5b8035906020019184600183028401116401000000008311171561009557600080fd5b91908080601f0160208091040260200160405190810160405280939291908181526020018383808284376000920191909152509295506100f8945050505050565b604080516bffffffffffffffffffffffff199092168252519081900360200190f35b60006040518251602084019350604067ffffffffffffffc06001830116016009828203106001811461012957610130565b6040820191505b50776745230100efcdab890098badcfe001032547600c3d2e1f0610183565b60008383101561017c5750808201519282900392602084101561017c5760001960208590036101000a0119165b9392505050565b60005b8281101561045c5761019984828961014f565b85526101a984602083018961014f565b6020860152604081850310600181146101c1576101ca565b60808286038701535b50604083038114600181146101de576101ee565b8460031b60208701511760208701525b5060405b608081101561027157858101603f19810151603719820151601f19830151600b1984015118911818600181901b7ffffffffefffffffefffffffefffffffefffffffefffffffefffffffefffffffe16601f9190911c7c010000000100000001000000010000000100000001000000010000000116179052600c016101f2565b5060805b6101408110156102f557858101607f19810151606f19820151603f1983015160171984015118911818600281901b7ffffffffcfffffffcfffffffcfffffffcfffffffcfffffffcfffffffcfffffffc16601e9190911c7c030000000300000003000000030000000300000003000000030000000316179052601801610275565b508160008060005b60508110156104325760148104801561032d576001811461034e576002811461036d5760038114610391576103ac565b602885901c605086901c8118607887901c16189350635a82799992506103ac565b8460501c8560781c189350838560281c189350636ed9eba192506103ac565b605085901c607886901c818117602888901c169116179350638f1bbcdc92506103ac565b8460501c8560781c189350838560281c18935063ca62c1d692505b50601f8460bb1c168063ffffffe086609b1c1617905080840190508063ffffffff86160190508083019050808260021b8b015160e01c0190508060a01b8560281c179450633fffffff8560521c1663c00000008660321c161760501b77ffffffff00ffffffff000000000000ffffffff00ffffffff8616179450506001810190506102fd565b5050509190910177ffffffff00ffffffff00ffffffff00ffffffff00ffffffff1690604001610186565b5063ffffffff811667ffffffff000000008260081c166bffffffff00000000000000008360101c166fffffffff0000000000000000000000008460181c1673ffffffff000000000000000000000000000000008560201c161717171760601b94505050505091905056fea165627a7a72305820227af8b272b9b0e3d345f580ebcde55f50e3e8b7ecafabffcadb92e55e4de68e0029");
const auto blake2b_shifts_code = from_hex("608060405234801561001057600080fd5b50600436106100365760003560e01c80631e0924231461003b578063d299dac0146102bb575b600080fd5b610282600480360360a081101561005157600080fd5b81019060208101813564010000000081111561006c57600080fd5b82018360208201111561007e57600080fd5b803590602001918460018302840111640100000000831117156100a057600080fd5b91908080601f01602080910402602001604051908101604052809392919081815260200183838082843760009201919091525092959493602081019350359150506401000000008111156100f357600080fd5b82018360208201111561010557600080fd5b8035906020019184600183028401116401000000008311171561012757600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600092019190915250929594936020810193503591505064010000000081111561017a57600080fd5b82018360208201111561018c57600080fd5b803590602001918460018302840111640100000000831117156101ae57600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600092019190915250929594936020810193503591505064010000000081111561020157600080fd5b82018360208201111561021357600080fd5b8035906020019184600183028401116401000000008311171561023557600080fd5b91908080601f0160208091040260200160405190810160405280939291908181526020018383808284376000920191909152509295505050903567ffffffffffffffff1691506103f49050565b604051808261010080838360005b838110156102a8578181015183820152602001610290565b5050505090500191505060405180910390f35b610282600480360360608110156102d157600080fd5b8101906020810181356401000000008111156102ec57600080fd5b8201836020820111156102fe57600080fd5b8035906020019184600183028401116401000000008311171561032057600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600092019190915250929594936020810193503591505064010000000081111561037357600080fd5b82018360208201111561038557600080fd5b803590602001918460018302840111640100000000831117156103a757600080fd5b91908080601f0160208091040260200160405190810160405280939291908181526020018383808284376000920191909152509295505050903567ffffffffffffffff1691506104489050565b6103fc61156d565b61040461158d565b61040c61156d565b61042982858961041b8a610485565b6104248a610485565b610538565b61043382896106dc565b61043d828261079b565b979650505050505050565b61045061156d565b61047d848460206040519081016040528060008152506020604051908101604052806000815250866103f4565b949350505050565b61048d6115ca565b60005b82518110156104fb5760088184018101519067ffffffffffffffff82166007841660010182026040031b9084908404600281106104c957fe5b6020020151188360088404600281106104de57fe5b67ffffffffffffffff909216602092909202015250600101610490565b5061050d8160005b60200201516108cd565b67ffffffffffffffff168152610524816001610503565b67ffffffffffffffff166020820152919050565b67ffffffffffffffff84161580610559575060408467ffffffffffffffff16115b80610565575060408351115b1561056f57600080fd5b61057761156d565b506040805161010081018252676a09e667f3bcc908815267bb67ae8584caa73b6020820152673c6ef372fe94f82b9181019190915267a54ff53a5f1d36f1606082015267510e527fade682d16080820152679b05688c2b3e6c1f60a0820152671f83d9abfb41bd6b60c0820152675be0cd19137e217960e082015260005b600881101561063d5781816008811061060a57fe5b602002015187602001518260088110151561062157fe5b67ffffffffffffffff90921660209290920201526001016105f5565b50835160208781018051805167ffffffffffffffff94851660081b188918630101000018841690528551815160809081018051909218851690915286830151825160a0018051909118851690528551825160c00180519091188516905291850151905160e00180519091188316905286821690880152845190600090821611156106d3576106cb87866106dc565b608060608801525b50505050505050565b60005b815181101561079657826060015167ffffffffffffffff166080141561074057606083015160408401805167ffffffffffffffff9092169091016fffffffffffffffffffffffffffffffff16905261073883600061094f565b600060608401525b60608301805167ffffffffffffffff600182018116909252166107616115e5565b508351835160009085908590811061077557fe5b90602001015160f81c60f81b60f81c905080838301535050506001016106df565b505050565b60608201805160408401805167ffffffffffffffff8084169182016fffffffffffffffffffffffffffffffff1690925260019092011690915260006107de6115e5565b508351825b60808110156107f95782818301536001016107e3565b5061080585600161094f565b60005b60808601516008900481101561085457602086015161082c90826008811061050357fe5b85826008811061083857fe5b67ffffffffffffffff9092166020929092020152600101610808565b506040856080015110156108c65760808501516020860151600860078316810260400392610889929190046008811061050357fe5b67ffffffffffffffff16901c84600887608001518115156108a657fe5b04600881106108b157fe5b67ffffffffffffffff90921660209290920201525b5050505050565b600067010000000000000060ff8316026501000000000061ff00841602630100000062ff000085160261010063ff000000861681029064ff00000000871604630100000065ff00000000008816046501000000000066ff00000000000089160467010000000000000067ff000000000000008a16041818181818181892915050565b610957611604565b61095f611604565b61096761156d565b506040805161010081018252676a09e667f3bcc908815267bb67ae8584caa73b6020820152673c6ef372fe94f82b9181019190915267a54ff53a5f1d36f1606082015267510e527fade682d16080820152679b05688c2b3e6c1f60a0820152671f83d9abfb41bd6b60c0820152675be0cd19137e217960e082015260005b6008811015610a5f57602086015181600881106109fe57fe5b6020020151848260108110610a0f57fe5b67ffffffffffffffff9092166020929092020152818160088110610a2f57fe5b6020020151846008830160108110610a4357fe5b67ffffffffffffffff90921660209290920201526001016109e5565b506040850180516101808501805167ffffffffffffffff928316188216905290516101a085018051680100000000000000006fffffffffffffffffffffffffffffffff9093169290920490911890911690528315610acc576101c0830180511967ffffffffffffffff1690525b600080805b60108160ff161015610b56576000925060038116801515610b0c578851600460ff84160460ff16600481101515610b0457fe5b602002015192505b67ffffffffffffffff83826003036040021c169350610b2a846108cd565b8660ff841660108110610b3957fe5b67ffffffffffffffff909216602092909202015250600101610ad1565b50610b7985600060046008600c89845b60200201518a60015b60200201516113e8565b610b9685600160056009600d8960025b60200201518a6003610b6f565b610bb38560026006600a600e8960045b60200201518a6005610b6f565b610bd08560036007600b600f8960065b60200201518a6007610b6f565b610bed8560006005600a600f8960085b60200201518a6009610b6f565b610c0a8560016006600b600c89600a5b60200201518a600b610b6f565b610c2785600260076008600d89600c5b60200201518a600d610b6f565b610c4385600360046009600e89815b60200201518a600f610b6f565b610c6085600060046008600c89600e5b60200201518a600a610b6f565b610c7d85600160056009600d8960045b60200201518a6008610b6f565b610c918560026006600a600e896009610c36565b610cae8560036007600b600f89600d5b60200201518a6006610b6f565b610ccb8560006005600a600f8960015b60200201518a600c610b6f565b610ce88560016006600b600c8960005b60200201518a6002610b6f565b610cfc85600260076008600d89600b610bc3565b610d1085600360046009600e896005610b89565b610d2485600060046008600c89600b610c70565b610d4185600160056009600d89600c5b60200201518a6000610b6f565b610d558560026006600a600e896005610cdb565b610d688560036007600b600f8981610c1a565b610d848560006005600a600f89825b60200201518a600e610b6f565b610d988560016006600b600c896003610ca1565b610dab85600260076008600d8983610b66565b610dc785600360046009600e89825b60200201518a6004610b6f565b610ddb85600060046008600c896007610be0565b610def85600160056009600d896003610b66565b610e038560026006600a600e89600d610cbe565b610e168560036007600b600f8982610d77565b610e2a8560006005600a600f896002610ca1565b610e3e8560016006600b600c896005610c53565b610e5285600260076008600d896004610d34565b610e6685600360046009600e89600f610c70565b610e7a85600060046008600c896009610d34565b610e8d85600160056009600d8983610bc3565b610ea08560026006600a600e8984610dba565b610eb48560036007600b600f89600a610c36565b610ec88560006005600a600f89600e610b66565b610edb8560016006600b600c8982610cbe565b610eef85600260076008600d896006610c70565b610f0285600360046009600e8984610c1a565b610f1685600060046008600c896002610cbe565b610f2a85600160056009600d896006610c53565b610f3e8560026006600a600e896000610bfd565b610f528560036007600b600f896008610b89565b610f668560006005600a600f896004610c1a565b610f7a8560016006600b600c896007610ba6565b610f8e85600260076008600d89600f610d77565b610fa285600360046009600e896001610be0565b610fb585600060046008600c8981610ba6565b610fc885600160056009600d8984610c36565b610fdb8560026006600a600e8981610c1a565b610fef8560036007600b600f896004610c53565b6110028560006005600a600f8984610bc3565b6110158560016006600b600c8983610b89565b61102985600260076008600d896009610cdb565b61103d85600360046009600e896008610bfd565b61105185600060046008600c89600d610bfd565b61106585600160056009600d896007610d77565b6110798560026006600a600e89600c610b66565b61108c8560036007600b600f8984610be0565b61109f8560006005600a600f8983610d34565b6110b38560016006600b600c89600f610dba565b6110c685600260076008600d8982610ca1565b6110da85600360046009600e896002610c53565b6110ee85600060046008600c896006610c36565b61110285600160056009600d89600e610be0565b6111168560026006600a600e89600b610b89565b61112a8560036007600b600f896000610c70565b61113e8560006005600a600f89600c610cdb565b6111528560016006600b600c89600d610bc3565b61116685600260076008600d896001610dba565b61117a85600360046009600e89600a610ba6565b61118e85600060046008600c89600a610cdb565b6111a285600160056009600d896008610dba565b6111b68560026006600a600e896007610ca1565b6111ca8560036007600b600f896001610ba6565b6111dd8560006005600a600f8981610bfd565b6111f18560016006600b600c896009610d77565b61120585600260076008600d896003610cbe565b61121985600360046009600e89600d610d34565b61122c85600060046008600c8984610b66565b61124085600160056009600d896002610b89565b6112548560026006600a600e896004610ba6565b6112688560036007600b600f896006610bc3565b61127c8560006005600a600f896008610be0565b6112908560016006600b600c89600a610bfd565b6112a485600260076008600d89600c610c1a565b6112b785600360046009600e8981610c36565b6112cb85600060046008600c89600e610c53565b6112df85600160056009600d896004610c70565b6112f38560026006600a600e896009610c36565b6113078560036007600b600f89600d610ca1565b61131b8560006005600a600f896001610cbe565b61132f8560016006600b600c896000610cdb565b61134385600260076008600d89600b610bc3565b61135785600360046009600e896005610b89565b60005b60088160ff1610156113de578560ff60088301166010811061137857fe5b60200201518660ff83166010811061138c57fe5b602002015189602001518360ff166008811015156113a657fe5b6020020151181888602001518260ff166008811015156113c257fe5b67ffffffffffffffff909216602092909202015260010161135a565b5050505050505050565b60008787601081106113f657fe5b60200201519050600088876010811061140b57fe5b60200201519050600089876010811061142057fe5b6020020151905060008a876010811061143557fe5b6020020151905068010000000000000000868486010893508318602081811c91901b67ffffffffffffffff161868010000000000000000818308915067ffffffffffffffff82841860281b1682841860181c18925068010000000000000000858486010893508318601081901c60309190911b67ffffffffffffffff161868010000000000000000818308928318603f81901c60019190911b67ffffffffffffffff1618929150838b8b601081106114e957fe5b67ffffffffffffffff9092166020929092020152828b8a6010811061150a57fe5b67ffffffffffffffff9092166020929092020152818b896010811061152b57fe5b67ffffffffffffffff9092166020929092020152808b886010811061154c57fe5b67ffffffffffffffff90921660209290920201525050505050505050505050565b610100604051908101604052806008906020820280388339509192915050565b6101e0604051908101604052806115a26115e5565b81526020016115af61156d565b81526000602082018190526040820181905260609091015290565b60408051808201825290600290829080388339509192915050565b6080604051908101604052806004906020820280388339509192915050565b61020060405190810160405280601090602082028038833950919291505056fea165627a7a72305820a59dc9d098d29bacdd88cb50c25c96ed4ba3047fd46a5c6ecf57e447a3c699100029");
const auto weierstrudel_code = from_hex("346060600036030617156100195761019060005260206000fd5b6060600036030460021b603e016102006136c66000396004810281600302826005020182601e01810383820384820385820386820387820388820360606000360304808001600a1b60e0019060061b6000015b60017f30644e72e131a029b85045b68181585d2833e84879b9709143e1f593f00000018235067f30644e72e131a029b85045b68181585d2833e84879b9709143e1f593f000000190067f30644e72e131a029b85045b68181585d2833e84879b9709143e1f593f000000180807fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff70024ccef014a773d2cf7a7bd9d4391eb18d850970024ccef014a773d2cf7a7bd9d4391eb18d85028082109103036789d3256894d213e3097f30644e72e131a029b85045b68181585d2833e84879b9709143e1f593f00000017fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff6802d91d232ec7e0b3d786096802d91d232ec7e0b3d786028082109103037f30644e72e131a029b85045b68181585cb8e665ff8b011694c1d039a872b0eed9090891818377b3c4d79d41a917585bfc41088d8daaa78b17ea66b99c90dd090860051b9060051b5b937ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc0001938e6005026060600036030461080002610200010390806101e01651565b908e019060041c806101e01651565b8060031c6103e0168601828f019283516002018085528f03015260081c601001806101e01651565b8060021c6103e0168601828d019283516002018085528d03015260071c601001806101e01651565b8060011c6103e0168601828b019283516002018085528b03015260061c601001806101e01651565b806103e01686018289019283516002018085528903015260051c601001806101e01651565b601f811161021b57509060018303926101da5750505060200180360361006c5750505050505050505050506000037f912CEB58A394E07D28F0D12384840918C6843FB439555FA7B461A4448976F7D57f60C89CE5C263405370A08B6D0302B0BB2F02D522D0E3951A7841182DB0F9FA8E7f30644E72E131A029B85045B68181585D97816A916871CA8D3C208C16D87CFD477759e26bcea0d48bacd4f263f1acdb5c4f5763473177fffffe60c0528260a052816080526000604003600360003603048001038060605280359060200135828080848009840960030883828009146103b65761019060005260206000fd5b82818009838160021b818080838809968009600302818180098783038001018a03806000528701099209840380019180016040528101602052826020518201600051840182808280098061040a5760006000fd5b818184099382828909830383808084800983800101880891820181930982878a09018b03829561052a565b604060605103606052808480808380098093098160605135819006606051602001358290068280808480098409600308838280091461047a5761019060005260206000fd5b9409920985818009868160021b81808287098103818780096003029082828009818001018060a051036000520109920980010160a051036020528583800182098060405290919286808084800993840994830987809486098403849283818009848080838509602051098401916000510984018580828009806104fd5760006000fd5b818184099382828909830383808084800983800101880891820181930982878a0901608051038280968199095b83818009848080838509602051098401916000510984018580828009806105515760006000fd5b818184099382828909830383808084800983800101880891820181930982878a09016080510382809681990983818009848080838509602051098401916000510984018580828009806105a45760006000fd5b818184099382828909830383808084800983800101880891820181930982878a09016080510382809681990983818009848080838509602051098401916000510984018580828009806105f75760006000fd5b818184099382828909830383808084800983800101880891820181930982878a090160805103828096819909838180098480808385096020510984019160005109840185808280098061064a5760006000fd5b818184099382828909830383808084800983800101880891820181930982878a090160805103828096819909838180098480808385096020510984019160005109840185808280098061069d5760006000fd5b818184099382828909830383808084800983800101880891820181930982878a09016080510382809681990983818009848080838509602051098401916000510984018580828009806106f05760006000fd5b818184099382828909830383808084800983800101880891820181930982878a09016080510382808097819a0960405109600060605103610435573d526001600160606000360304600f036101cd0261074501565b91849083098061732052806176e0528403806172e0526177205291839083098303838160c05109806176c05261770052806172c05261730052920993099384098061736052806176a0528203806172a0526177605292830983038360c051820980617680526177405280617280526173405292099309938409806173a0528061766052820380617260526177a05292830983038360c051820980617640526177805280617240526173805292099309938409806173e0528061762052820380617220526177e05292830983038360c051820980617600526177c05280617200526173c052920993099384098061742052806175e0528203806171e0526178205292830983038360c0518209806175c05261780052806171c05261740052920993099384098061746052806175a0528203806171a0526178605292830983038360c051820980617580526178405280617180526174405292099309938409806174a0528061756052820380617160526178a05292830983038360c051820980617540526178805280617140526174805292099309938409806174e0528061752052820380617120526178e05292830985038560c051820980617500526178c05280617100526174c052920992095b918490830980616b205280616ee052840380616ae052616f205291839083098303838160c0510980616ec052616f005280616ac052616b00529209930993840980616b605280616ea052820380616aa052616f605292830983038360c051820980616e8052616f405280616a8052616b40529209930993840980616ba05280616e6052820380616a6052616fa05292830983038360c051820980616e4052616f805280616a4052616b80529209930993840980616be05280616e2052820380616a2052616fe05292830983038360c051820980616e0052616fc05280616a0052616bc0529209930993840980616c205280616de0528203806169e0526170205292830983038360c051820980616dc05261700052806169c052616c00529209930993840980616c605280616da0528203806169a0526170605292830983038360c051820980616d8052617040528061698052616c40529209930993840980616ca05280616d6052820380616960526170a05292830983038360c051820980616d4052617080528061694052616c80529209930993840980616ce05280616d2052820380616920526170e05292830985038560c051820980616d00526170c0528061690052616cc052920992095b91849083098061632052806166e0528403806162e0526167205291839083098303838160c05109806166c05261670052806162c05261630052920993099384098061636052806166a0528203806162a0526167605292830983038360c051820980616680526167405280616280526163405292099309938409806163a0528061666052820380616260526167a05292830983038360c051820980616640526167805280616240526163805292099309938409806163e0528061662052820380616220526167e05292830983038360c051820980616600526167c05280616200526163c052920993099384098061642052806165e0528203806161e0526168205292830983038360c0518209806165c05261680052806161c05261640052920993099384098061646052806165a0528203806161a0526168605292830983038360c051820980616580526168405280616180526164405292099309938409806164a0528061656052820380616160526168a05292830983038360c051820980616540526168805280616140526164805292099309938409806164e0528061652052820380616120526168e05292830985038560c051820980616500526168c05280616100526164c052920992095b918490830980615b205280615ee052840380615ae052615f205291839083098303838160c0510980615ec052615f005280615ac052615b00529209930993840980615b605280615ea052820380615aa052615f605292830983038360c051820980615e8052615f405280615a8052615b40529209930993840980615ba05280615e6052820380615a6052615fa05292830983038360c051820980615e4052615f805280615a4052615b80529209930993840980615be05280615e2052820380615a2052615fe05292830983038360c051820980615e0052615fc05280615a0052615bc0529209930993840980615c205280615de0528203806159e0526160205292830983038360c051820980615dc05261600052806159c052615c00529209930993840980615c605280615da0528203806159a0526160605292830983038360c051820980615d8052616040528061598052615c40529209930993840980615ca05280615d6052820380615960526160a05292830983038360c051820980615d4052616080528061594052615c80529209930993840980615ce05280615d2052820380615920526160e05292830985038560c051820980615d00526160c0528061590052615cc052920992095b91849083098061532052806156e0528403806152e0526157205291839083098303838160c05109806156c05261570052806152c05261530052920993099384098061536052806156a0528203806152a0526157605292830983038360c051820980615680526157405280615280526153405292099309938409806153a0528061566052820380615260526157a05292830983038360c051820980615640526157805280615240526153805292099309938409806153e0528061562052820380615220526157e05292830983038360c051820980615600526157c05280615200526153c052920993099384098061542052806155e0528203806151e0526158205292830983038360c0518209806155c05261580052806151c05261540052920993099384098061546052806155a0528203806151a0526158605292830983038360c051820980615580526158405280615180526154405292099309938409806154a0528061556052820380615160526158a05292830983038360c051820980615540526158805280615140526154805292099309938409806154e0528061552052820380615120526158e05292830985038560c051820980615500526158c05280615100526154c052920992095b918490830980614b205280614ee052840380614ae052614f205291839083098303838160c0510980614ec052614f005280614ac052614b00529209930993840980614b605280614ea052820380614aa052614f605292830983038360c051820980614e8052614f405280614a8052614b40529209930993840980614ba05280614e6052820380614a6052614fa05292830983038360c051820980614e4052614f805280614a4052614b80529209930993840980614be05280614e2052820380614a2052614fe05292830983038360c051820980614e0052614fc05280614a0052614bc0529209930993840980614c205280614de0528203806149e0526150205292830983038360c051820980614dc05261500052806149c052614c00529209930993840980614c605280614da0528203806149a0526150605292830983038360c051820980614d8052615040528061498052614c40529209930993840980614ca05280614d6052820380614960526150a05292830983038360c051820980614d4052615080528061494052614c80529209930993840980614ce05280614d2052820380614920526150e05292830985038560c051820980614d00526150c0528061490052614cc052920992095b91849083098061432052806146e0528403806142e0526147205291839083098303838160c05109806146c05261470052806142c05261430052920993099384098061436052806146a0528203806142a0526147605292830983038360c051820980614680526147405280614280526143405292099309938409806143a0528061466052820380614260526147a05292830983038360c051820980614640526147805280614240526143805292099309938409806143e0528061462052820380614220526147e05292830983038360c051820980614600526147c05280614200526143c052920993099384098061442052806145e0528203806141e0526148205292830983038360c0518209806145c05261480052806141c05261440052920993099384098061446052806145a0528203806141a0526148605292830983038360c051820980614580526148405280614180526144405292099309938409806144a0528061456052820380614160526148a05292830983038360c051820980614540526148805280614140526144805292099309938409806144e0528061452052820380614120526148e05292830985038560c051820980614500526148c05280614100526144c052920992095b918490830980613b205280613ee052840380613ae052613f205291839083098303838160c0510980613ec052613f005280613ac052613b00529209930993840980613b605280613ea052820380613aa052613f605292830983038360c051820980613e8052613f405280613a8052613b40529209930993840980613ba05280613e6052820380613a6052613fa05292830983038360c051820980613e4052613f805280613a4052613b80529209930993840980613be05280613e2052820380613a2052613fe05292830983038360c051820980613e0052613fc05280613a0052613bc0529209930993840980613c205280613de0528203806139e0526140205292830983038360c051820980613dc05261400052806139c052613c00529209930993840980613c605280613da0528203806139a0526140605292830983038360c051820980613d8052614040528061398052613c40529209930993840980613ca05280613d6052820380613960526140a05292830983038360c051820980613d4052614080528061394052613c80529209930993840980613ce05280613d2052820380613920526140e05292830985038560c051820980613d00526140c0528061390052613cc052920992095b91849083098061332052806136e0528403806132e0526137205291839083098303838160c05109806136c05261370052806132c05261330052920993099384098061336052806136a0528203806132a0526137605292830983038360c051820980613680526137405280613280526133405292099309938409806133a0528061366052820380613260526137a05292830983038360c051820980613640526137805280613240526133805292099309938409806133e0528061362052820380613220526137e05292830983038360c051820980613600526137c05280613200526133c052920993099384098061342052806135e0528203806131e0526138205292830983038360c0518209806135c05261380052806131c05261340052920993099384098061346052806135a0528203806131a0526138605292830983038360c051820980613580526138405280613180526134405292099309938409806134a0528061356052820380613160526138a05292830983038360c051820980613540526138805280613140526134805292099309938409806134e0528061352052820380613120526138e05292830985038560c051820980613500526138c05280613100526134c052920992095b918490830980612b205280612ee052840380612ae052612f205291839083098303838160c0510980612ec052612f005280612ac052612b00529209930993840980612b605280612ea052820380612aa052612f605292830983038360c051820980612e8052612f405280612a8052612b40529209930993840980612ba05280612e6052820380612a6052612fa05292830983038360c051820980612e4052612f805280612a4052612b80529209930993840980612be05280612e2052820380612a2052612fe05292830983038360c051820980612e0052612fc05280612a0052612bc0529209930993840980612c205280612de0528203806129e0526130205292830983038360c051820980612dc05261300052806129c052612c00529209930993840980612c605280612da0528203806129a0526130605292830983038360c051820980612d8052613040528061298052612c40529209930993840980612ca05280612d6052820380612960526130a05292830983038360c051820980612d4052613080528061294052612c80529209930993840980612ce05280612d2052820380612920526130e05292830985038560c051820980612d00526130c0528061290052612cc052920992095b91849083098061232052806126e0528403806122e0526127205291839083098303838160c05109806126c05261270052806122c05261230052920993099384098061236052806126a0528203806122a0526127605292830983038360c051820980612680526127405280612280526123405292099309938409806123a0528061266052820380612260526127a05292830983038360c051820980612640526127805280612240526123805292099309938409806123e0528061262052820380612220526127e05292830983038360c051820980612600526127c05280612200526123c052920993099384098061242052806125e0528203806121e0526128205292830983038360c0518209806125c05261280052806121c05261240052920993099384098061246052806125a0528203806121a0526128605292830983038360c051820980612580526128405280612180526124405292099309938409806124a0528061256052820380612160526128a05292830983038360c051820980612540526128805280612140526124805292099309938409806124e0528061252052820380612120526128e05292830985038560c051820980612500526128c05280612100526124c052920992095b918490830980611b205280611ee052840380611ae052611f205291839083098303838160c0510980611ec052611f005280611ac052611b00529209930993840980611b605280611ea052820380611aa052611f605292830983038360c051820980611e8052611f405280611a8052611b40529209930993840980611ba05280611e6052820380611a6052611fa05292830983038360c051820980611e4052611f805280611a4052611b80529209930993840980611be05280611e2052820380611a2052611fe05292830983038360c051820980611e0052611fc05280611a0052611bc0529209930993840980611c205280611de0528203806119e0526120205292830983038360c051820980611dc05261200052806119c052611c00529209930993840980611c605280611da0528203806119a0526120605292830983038360c051820980611d8052612040528061198052611c40529209930993840980611ca05280611d6052820380611960526120a05292830983038360c051820980611d4052612080528061194052611c80529209930993840980611ce05280611d2052820380611920526120e05292830985038560c051820980611d00526120c0528061190052611cc052920992095b91849083098061132052806116e0528403806112e0526117205291839083098303838160c05109806116c05261170052806112c05261130052920993099384098061136052806116a0528203806112a0526117605292830983038360c051820980611680526117405280611280526113405292099309938409806113a0528061166052820380611260526117a05292830983038360c051820980611640526117805280611240526113805292099309938409806113e0528061162052820380611220526117e05292830983038360c051820980611600526117c05280611200526113c052920993099384098061142052806115e0528203806111e0526118205292830983038360c0518209806115c05261180052806111c05261140052920993099384098061146052806115a0528203806111a0526118605292830983038360c051820980611580526118405280611180526114405292099309938409806114a0528061156052820380611160526118a05292830983038360c051820980611540526118805280611140526114805292099309938409806114e0528061152052820380611120526118e05292830985038560c051820980611500526118c05280611100526114c052920992095b918490830980610b205280610ee052840380610ae052610f205291839083098303838160c0510980610ec052610f005280610ac052610b00529209930993840980610b605280610ea052820380610aa052610f605292830983038360c051820980610e8052610f405280610a8052610b40529209930993840980610ba05280610e6052820380610a6052610fa05292830983038360c051820980610e4052610f805280610a4052610b80529209930993840980610be05280610e2052820380610a2052610fe05292830983038360c051820980610e0052610fc05280610a0052610bc0529209930993840980610c205280610de0528203806109e0526110205292830983038360c051820980610dc05261100052806109c052610c00529209930993840980610c605280610da0528203806109a0526110605292830983038360c051820980610d8052611040528061098052610c40529209930993840980610ca05280610d6052820380610960526110a05292830983038360c051820980610d4052611080528061094052610c80529209930993840980610ce05280610d2052820380610920526110e05292830985038560c051820980610d00526110c0528061090052610cc052920992095b91849083098061032052806106e0528403806102e0526107205291839083098303838160c05109806106c05261070052806102c05261030052920993099384098061036052806106a0528203806102a0526107605292830983038360c051820980610680526107405280610280526103405292099309938409806103a0528061066052820380610260526107a05292830983038360c051820980610640526107805280610240526103805292099309938409806103e0528061062052820380610220526107e05292830983038360c051820980610600526107c05280610200526103c052920993099384098061042052806105e0528203806101e0526108205292830983038360c0518209806105c05261080052806101c05261040052920993099384098061046052806105a0528203806101a0526108605292830983038360c051820980610580526108405280610180526104405292099309938409806104a0528061056052820380610160526108a05292830983038360c051820980610540526108805280610140526104805298090981038160c051820980610500526108c05280610100526104c052930909806104e0528061052052810380610120526108e0523d518460071b606060003603046108000261020001035b850180511561225657607c6138c6601e3980518103601e870301516202ffe0168051840390602001518403600160606000360304610800026102000151603e01606060003603046108000261020001526002848a019451035161ffff16565b858082800981605a8703516202ffe0168060200151828685098391098601928291510986018180808380098184820999098103968189818780098a800101089809940993850109018603905b85808280098160588703516202ffe0168060200151828685098391098601928291510986018180808380098184820999098103968189818780098a800101089809940993850109018603905b85808280098160568703516202ffe0168060200151828685098391098601928291510986018180808380098184820999098103968189818780098a800101089809940993850109018603905b85808280098160548703516202ffe0168060200151828685098391098601928291510986018180808380098184820999098103968189818780098a800101089809940993850109018603905b85808280098160528703516202ffe0168060200151828685098391098601928291510986018180808380098184820999098103968189818780098a800101089809940993850109018603905b85808280098160508703516202ffe0168060200151828685098391098601928291510986018180808380098184820999098103968189818780098a800101089809940993850109018603905b858082800981604e8703516202ffe0168060200151828685098391098601928291510986018180808380098184820999098103968189818780098a800101089809940993850109018603905b858082800981604c8703516202ffe0168060200151828685098391098601928291510986018180808380098184820999098103968189818780098a800101089809940993850109018603905b858082800981604a8703516202ffe0168060200151828685098391098601928291510986018180808380098184820999098103968189818780098a800101089809940993850109018603905b85808280098160488703516202ffe0168060200151828685098391098601928291510986018180808380098184820999098103968189818780098a800101089809940993850109018603905b85808280098160468703516202ffe0168060200151828685098391098601928291510986018180808380098184820999098103968189818780098a800101089809940993850109018603905b85808280098160448703516202ffe0168060200151828685098391098601928291510986018180808380098184820999098103968189818780098a800101089809940993850109018603905b85808280098160428703516202ffe0168060200151828685098391098601928291510986018180808380098184820999098103968189818780098a800101089809940993850109018603905b85808280098160408703516202ffe0168060200151828685098391098601928291510986018180808380098184820999098103968189818780098a800101089809940993850109018603905b858082800981603e8703516202ffe0168060200151828685098391098601928291510986018180808380098184820999098103968189818780098a800101089809940993850109018603905b858082800981603c8703516202ffe0168060200151828685098391098601928291510986018180808380098184820999098103968189818780098a800101089809940993850109018603905b858082800981603a8703516202ffe0168060200151828685098391098601928291510986018180808380098184820999098103968189818780098a800101089809940993850109018603905b85808280098160388703516202ffe0168060200151828685098391098601928291510986018180808380098184820999098103968189818780098a800101089809940993850109018603905b85808280098160368703516202ffe0168060200151828685098391098601928291510986018180808380098184820999098103968189818780098a800101089809940993850109018603905b85808280098160348703516202ffe0168060200151828685098391098601928291510986018180808380098184820999098103968189818780098a800101089809940993850109018603905b85808280098160328703516202ffe0168060200151828685098391098601928291510986018180808380098184820999098103968189818780098a800101089809940993850109018603905b85808280098160308703516202ffe0168060200151828685098391098601928291510986018180808380098184820999098103968189818780098a800101089809940993850109018603905b858082800981602e8703516202ffe0168060200151828685098391098601928291510986018180808380098184820999098103968189818780098a800101089809940993850109018603905b858082800981602c8703516202ffe0168060200151828685098391098601928291510986018180808380098184820999098103968189818780098a800101089809940993850109018603905b858082800981602a8703516202ffe0168060200151828685098391098601928291510986018180808380098184820999098103968189818780098a800101089809940993850109018603905b85808280098160288703516202ffe0168060200151828685098391098601928291510986018180808380098184820999098103968189818780098a800101089809940993850109018603905b85808280098160268703516202ffe0168060200151828685098391098601928291510986018180808380098184820999098103968189818780098a800101089809940993850109018603905b85808280098160248703516202ffe0168060200151828685098391098601928291510986018180808380098184820999098103968189818780098a800101089809940993850109018603905b85808280098160228703516202ffe0168060200151828685098391098601928291510986018180808380098184820999098103968189818780098a800101089809940993850109018603905b85808280098160208703516202ffe0168060200151828685098391098601928291510986018180808380098184820999098103968189818780098a800101089809940993850109018603905b8582800192830986818001818080838909810397800960030281818009888001019788010992090191869109850388840193515161ffff16565b858082800981605a8703516202ffe0168060200151828685098391098601928291510986018180808380098184820999098103968189818780098a800101089809940993850109018603905b85808280098160588703516202ffe0168060200151828685098391098601928291510986018180808380098184820999098103968189818780098a800101089809940993850109018603905b85808280098160568703516202ffe0168060200151828685098391098601928291510986018180808380098184820999098103968189818780098a800101089809940993850109018603905b85808280098160548703516202ffe0168060200151828685098391098601928291510986018180808380098184820999098103968189818780098a800101089809940993850109018603905b85808280098160528703516202ffe0168060200151828685098391098601928291510986018180808380098184820999098103968189818780098a800101089809940993850109018603905b85808280098160508703516202ffe0168060200151828685098391098601928291510986018180808380098184820999098103968189818780098a800101089809940993850109018603905b858082800981604e8703516202ffe0168060200151828685098391098601928291510986018180808380098184820999098103968189818780098a800101089809940993850109018603905b858082800981604c8703516202ffe0168060200151828685098391098601928291510986018180808380098184820999098103968189818780098a800101089809940993850109018603905b858082800981604a8703516202ffe0168060200151828685098391098601928291510986018180808380098184820999098103968189818780098a800101089809940993850109018603905b85808280098160488703516202ffe0168060200151828685098391098601928291510986018180808380098184820999098103968189818780098a800101089809940993850109018603905b85808280098160468703516202ffe0168060200151828685098391098601928291510986018180808380098184820999098103968189818780098a800101089809940993850109018603905b85808280098160448703516202ffe0168060200151828685098391098601928291510986018180808380098184820999098103968189818780098a800101089809940993850109018603905b85808280098160428703516202ffe0168060200151828685098391098601928291510986018180808380098184820999098103968189818780098a800101089809940993850109018603905b85808280098160408703516202ffe0168060200151828685098391098601928291510986018180808380098184820999098103968189818780098a800101089809940993850109018603905b858082800981603e8703516202ffe0168060200151828685098391098601928291510986018180808380098184820999098103968189818780098a800101089809940993850109018603905b858082800981603c8703516202ffe0168060200151828685098391098601928291510986018180808380098184820999098103968189818780098a800101089809940993850109018603905b858082800981603a8703516202ffe0168060200151828685098391098601928291510986018180808380098184820999098103968189818780098a800101089809940993850109018603905b85808280098160388703516202ffe0168060200151828685098391098601928291510986018180808380098184820999098103968189818780098a800101089809940993850109018603905b85808280098160368703516202ffe0168060200151828685098391098601928291510986018180808380098184820999098103968189818780098a800101089809940993850109018603905b85808280098160348703516202ffe0168060200151828685098391098601928291510986018180808380098184820999098103968189818780098a800101089809940993850109018603905b85808280098160328703516202ffe0168060200151828685098391098601928291510986018180808380098184820999098103968189818780098a800101089809940993850109018603905b85808280098160308703516202ffe0168060200151828685098391098601928291510986018180808380098184820999098103968189818780098a800101089809940993850109018603905b858082800981602e8703516202ffe0168060200151828685098391098601928291510986018180808380098184820999098103968189818780098a800101089809940993850109018603905b858082800981602c8703516202ffe0168060200151828685098391098601928291510986018180808380098184820999098103968189818780098a800101089809940993850109018603905b858082800981602a8703516202ffe0168060200151828685098391098601928291510986018180808380098184820999098103968189818780098a800101089809940993850109018603905b85808280098160288703516202ffe0168060200151828685098391098601928291510986018180808380098184820999098103968189818780098a800101089809940993850109018603905b85808280098160268703516202ffe0168060200151828685098391098601928291510986018180808380098184820999098103968189818780098a800101089809940993850109018603905b85808280098160248703516202ffe0168060200151828685098391098601928291510986018180808380098184820999098103968189818780098a800101089809940993850109018603905b85808280098160228703516202ffe0168060200151828685098391098601928291510986018180808380098184820999098103968189818780098a800101089809940993850109018603905b85808280098160208703516202ffe0168060200151828685098391098601928291510986018180808380098184820999098103968189818780098a800101089809940993850109018603905b806136a757505050508460071b606060003603046108000261020001035b85018051156134dd57603e60606000360304610800026102000151036060600036030461080002610200015280518103601e870301516202ffe0168051840390602001518403600160028451038452835161353757613627565b85808280098186516002810388528703601e8d0301516202ffe016806020015182868509839109860192829151098601818080838009806135ff57876135a8575050505086516002810388528703601e8d0301516202ffe01680602001518203955051900394505050506001613620565b818680096135ea575050505050505085828001928309868180018180808389098103978009600302818180098880010197880109920901918691098503613620565b50505050505050505050600060016000613620565b8184820999098103968189818780098a800101089809940993850109018603905b8351613537575b836060600036030461080002610200011461367a57858280019283098681800181808083890981039780096003028181800988800101978801099209019186910985039288019283511561362757613537565b806136a757801582600114841516166136935760006000fd5b60405260205260005250505050505060603df35b8486910960405284900684036020528390063d5250505050505060603df300000000000000000000000000000000000000000000000000000000000002c700000000000000000000000000000000000000000000000000000000000002a2000000000000000000000000000000000000000000000000000000000000027a00000000000000000000000000000000000000000000000000000000000002a2000000000000000000000000000000000000000000000000000000000000025200000000000000000000000000000000000000000000000000000000000002a2000000000000000000000000000000000000000000000000000000000000027a00000000000000000000000000000000000000000000000000000000000002a2000000000000000000000000000000000000000000000000000000000000022a00000000000000000000000000000000000000000000000000000000000002a2000000000000000000000000000000000000000000000000000000000000027a00000000000000000000000000000000000000000000000000000000000002a2000000000000000000000000000000000000000000000000000000000000025200000000000000000000000000000000000000000000000000000000000002a2000000000000000000000000000000000000000000000000000000000000027a00000000000000000000000000000000000000000000000000000000000002a22b9d2b512b052ab92a6d2a2129d52989293d28f128a52859280d27c12775272926dd2691264525f925ad2561251524c9247d243123e52399234d230122b534bf3473342733db338f334332f732ab325f321331c7317b312f30e33097304b2fff2fb32f672f1b2ecf2e832e372deb2d9f2d532d072cbb2c6f2c232bd7");
const auto blake2b_huff_code = from_hex("60003560411161000f5760006000fd5b7f00000000ffffffffffffffff00000000000000000000000000000000000000007f0000000000000000000000000000000000000000ffffffffffffffff000000007f00000000ffffffffffffffff0000000000000000ffffffffffffffff000000007f000000006a09e667f3bcc9080000000000000000bb67ae8584caa73b0000000060003560a01b187701010000000000000000000000000000000000000000000018610240527f000000003c6ef372fe94f82b0000000000000000a54ff53a5f1d36f100000000610260527f00000000510e527fade682d100000000000000009b05688c2b3e6c1f00000000610280527f000000001f83d9abfb41bd6b00000000000000005be0cd19137e2179000000006102a05260203603600061219d565b6080816020016020376080017fffffffffffffffff0000000000000000000000000000000000000000000000007f0000000000000000ffffffffffffffff000000000000000000000000000000007f00000000000000000000000000000000ffffffffffffffff00000000000000007f000000000000000000000000000000000000000000000000ffffffffffffffff602051807fffffffff00000000ffffffff00000000ffffffff00000000ffffffff000000001660201c907f00000000ffffffff00000000ffffffff00000000ffffffff00000000ffffffff1660201b17807fffff0000ffff0000ffff0000ffff0000ffff0000ffff0000ffff0000ffff00001660101c907f0000ffff0000ffff0000ffff0000ffff0000ffff0000ffff0000ffff0000ffff1660101b17807fff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff001660081c907f00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff1660081b17604051807fffffffff00000000ffffffff00000000ffffffff00000000ffffffff000000001660201c907f00000000ffffffff00000000ffffffff00000000ffffffff00000000ffffffff1660201b17807fffff0000ffff0000ffff0000ffff0000ffff0000ffff0000ffff0000ffff00001660101c907f0000ffff0000ffff0000ffff0000ffff0000ffff0000ffff0000ffff0000ffff1660101b17807fff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff001660081c907f00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff1660081b17606051807fffffffff00000000ffffffff00000000ffffffff00000000ffffffff000000001660201c907f00000000ffffffff00000000ffffffff00000000ffffffff00000000ffffffff1660201b17807fffff0000ffff0000ffff0000ffff0000ffff0000ffff0000ffff0000ffff00001660101c907f0000ffff0000ffff0000ffff0000ffff0000ffff0000ffff0000ffff0000ffff1660101b17807fff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff001660081c907f00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff1660081b17608051807fffffffff00000000ffffffff00000000ffffffff00000000ffffffff000000001660201c907f00000000ffffffff00000000ffffffff00000000ffffffff00000000ffffffff1660201b17807fffff0000ffff0000ffff0000ffff0000ffff0000ffff0000ffff0000ffff00001660101c907f0000ffff0000ffff0000ffff0000ffff0000ffff0000ffff0000ffff0000ffff1660101b17807fff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff001660081c907f00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff1660081b178088166101a05280871660401b6101c05280861660801b6101e052841660c01b610200528087166101205280861660401b6101405280851660801b61016052831660c01b6101805280861660a05280851660401b60c05280841660801b60e052821660c01b6101005280851660205280841660401b60405280831660801b606052811660c01b608052505050507f00000000510e527fade682d100000000000000009b05688c2b3e6c1f000000008160a01b18610300527f000000001f83d9abfb41bd6b00000000000000005be0cd19137e217900000000610320527f000000003c6ef372fe94f82b0000000000000000a54ff53a5f1d36f1000000006102e0527f000000006a09e667f3bcc9080000000000000000bb67ae8584caa73b000000006102c0526102405161026051610280516102a051610300516102c051610280516102405181601c51604c511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a169283603c51606c511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166102805261030052610240526102c052610320516102e0516102a0516102605181609c5160cc511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a16928360bc5160ec511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166102a05261032052610260526102e0526103305189166102f05189161761034052610340516102e05161029051610240518161011c5161014c511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a16928361013c5161016c511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166102905261034052610240526102e0526102b05189166102705189161761036052610310516102c05161036051610260518161019c516101cc511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a1692836101bc516101ec511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166103605261031052610260526102c05261036051808a166102b0518a16176102b0528816610270518a16176102705261034051806103305288166102f0518a16176102f052610300516102c0516102805161024051816101dc51608c511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a16928361015c5161010c511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166102805261030052610240526102c052610320516102e0516102a051610260518161013c516101ac511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a1692836101fc5160cc511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166102a05261032052610260526102e0526103305189166102f05189161761034052610340516102e051610290516102405181603c51600c511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a16928361019c51604c511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166102905261034052610240526102e0526102b05189166102705189161761036052610310516102c05161036051610260518161017c5160ac511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a16928360fc51606c511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166103605261031052610260526102c05261036051808a166102b0518a16176102b0528816610270518a16176102705261034051806103305288166102f0518a16176102f052610300516102c05161028051610240518161017c5161018c511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a16928361011c51600c511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166102805261030052610240526102c052610320516102e0516102a051610260518160bc516101ec511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a169283605c516101ac511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166102a05261032052610260526102e0526103305189166102f05189161761034052610340516102e05161029051610240518161015c51606c511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a1692836101dc5160cc511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166102905261034052610240526102e0526102b05189166102705189161761036052610310516102c05161036051610260518160fc5161012c511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a169283603c51608c511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166103605261031052610260526102c05261036051808a166102b0518a16176102b0528816610270518a16176102705261034051806103305288166102f0518a16176102f052610300516102c05161028051610240518160fc51606c511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a16928361013c51602c511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166102805261030052610240526102c052610320516102e0516102a05161026051816101bc5161016c511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a16928361019c516101cc511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166102a05261032052610260526102e0526103305189166102f05189161761034052610340516102e051610290516102405181605c5160ac511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a16928360dc5161014c511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166102905261034052610240526102e0526102b05189166102705189161761036052610310516102c051610360516102605181609c516101ec511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a169283601c5161010c511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166103605261031052610260526102c05261036051808a166102b0518a16176102b0528816610270518a16176102705261034051806103305288166102f0518a16176102f052610300516102c05161028051610240518161013c5160ac511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a169283601c5160ec511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166102805261030052610240526102c052610320516102e0516102a0516102605181605c5161014c511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a169283609c516101ec511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166102a05261032052610260526102e0526103305189166102f05189161761034052610340516102e0516102905161024051816101dc5161016c511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a169283603c5161018c511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166102905261034052610240526102e0526102b05189166102705189161761036052610310516102c05161036051610260518160dc51606c511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a16928361011c516101ac511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166103605261031052610260526102c05261036051808a166102b0518a16176102b0528816610270518a16176102705261034051806103305288166102f0518a16176102f052610300516102c051610280516102405181605c5160cc511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a16928361019c5161014c511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166102805261030052610240526102c052610320516102e0516102a0516102605181601c5161010c511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a16928361017c51606c511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166102a05261032052610260526102e0526103305189166102f05189161761034052610340516102e051610290516102405181609c5160ec511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a1692836101bc5160ac511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166102905261034052610240526102e0526102b05189166102705189161761036052610310516102c0516103605161026051816101fc51602c511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a1692836101dc5161012c511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166103605261031052610260526102c05261036051808a166102b0518a16176102b0528816610270518a16176102705261034051806103305288166102f0518a16176102f052610300516102c05161028051610240518161019c51602c511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a16928360bc516101ec511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166102805261030052610240526102c052610320516102e0516102a05161026051816101dc51608c511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a1692836101bc5161014c511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166102a05261032052610260526102e0526103305189166102f05189161761034052610340516102e051610290516102405181601c5160cc511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a16928360fc51606c511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166102905261034052610240526102e0526102b05189166102705189161761036052610310516102c05161036051610260518161013c5161010c511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a169283605c5161016c511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166103605261031052610260526102c05261036051808a166102b0518a16176102b0528816610270518a16176102705261034051806103305288166102f0518a16176102f052610300516102c0516102805161024051816101bc5160ec511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a16928361017c516101cc511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166102805261030052610240526102c052610320516102e0516102a051610260518161019c51606c511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a169283603c5161012c511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166102a05261032052610260526102e0526103305189166102f05189161761034052610340516102e05161029051610240518160bc516101ec511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a169283601c51608c511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166102905261034052610240526102e0526102b05189166102705189161761036052610310516102c05161036051610260518161011c51604c511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a16928360dc5161014c511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166103605261031052610260526102c05261036051808a166102b0518a16176102b0528816610270518a16176102705261034051806103305288166102f0518a16176102f052610300516102c05161028051610240518160dc516101cc511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a1692836101fc5161012c511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166102805261030052610240526102c052610320516102e0516102a051610260518161017c51600c511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a169283607c5161010c511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166102a05261032052610260526102e0526103305189166102f05189161761034052610340516102e05161029051610240518161019c516101ac511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a169283605c5160ec511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166102905261034052610240526102e0526102b05189166102705189161761036052610310516102c051610360516102605181603c5161014c511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a169283609c5160ac511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166103605261031052610260526102c05261036051808a166102b0518a16176102b0528816610270518a16176102705261034051806103305288166102f0518a16176102f052610300516102c05161028051610240518161015c5161010c511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a169283605c51608c511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166102805261030052610240526102c052610320516102e0516102a051610260518160fc51602c511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a16928360dc5160ac511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166102a05261032052610260526102e0526103305189166102f05189161761034052610340516102e0516102905161024051816101fc5161012c511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a16928361017c516101cc511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166102905261034052610240526102e0526102b05189166102705189161761036052610310516102c051610360516102605181607c516101ac511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a16928361019c51600c511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166103605261031052610260526102c05261036051808a166102b0518a16176102b0528816610270518a16176102705261034051806103305288166102f0518a16176102f052610300516102c051610280516102405181601c51604c511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a169283603c51606c511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166102805261030052610240526102c052610320516102e0516102a0516102605181609c5160cc511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a16928360bc5160ec511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166102a05261032052610260526102e0526103305189166102f05189161761034052610340516102e05161029051610240518161011c5161014c511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a16928361013c5161016c511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166102905261034052610240526102e0526102b05189166102705189161761036052610310516102c05161036051610260518161019c516101cc511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a1692836101bc516101ec511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166103605261031052610260526102c05261036051808a166102b0518a16176102b0528816610270518a16176102705261034051806103305288166102f0518a16176102f052610300516102c0516102805161024051816101dc51608c511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a16928361015c5161010c511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166102805261030052610240526102c052610320516102e0516102a051610260518161013c516101ac511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a1692836101fc5160cc511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166102a05261032052610260526102e0526103305189166102f05189161761034052610340516102e051610290516102405181603c51600c511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a16928361019c51604c511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166102905261034052610240526102e0526102b05189166102705189161761036052610310516102c05161036051610260518161017c5160ac511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a16928360fc51606c511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166103605261031052610260526102c05261036051808a166102b0518a16176102b0528816610270518a16176102705261034051806103305288166102f0518a16176102f0526102a0511861032051186102a052610280511861030051186102805261026051186102e051186102605261024051186102c05118610240525b81816080011061013257600060205260006040526000606052600060805280820381602001602037907fffffffffffffffff0000000000000000000000000000000000000000000000007f0000000000000000ffffffffffffffff000000000000000000000000000000007f00000000000000000000000000000000ffffffffffffffff00000000000000007f000000000000000000000000000000000000000000000000ffffffffffffffff602051807fffffffff00000000ffffffff00000000ffffffff00000000ffffffff000000001660201c907f00000000ffffffff00000000ffffffff00000000ffffffff00000000ffffffff1660201b17807fffff0000ffff0000ffff0000ffff0000ffff0000ffff0000ffff0000ffff00001660101c907f0000ffff0000ffff0000ffff0000ffff0000ffff0000ffff0000ffff0000ffff1660101b17807fff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff001660081c907f00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff1660081b17604051807fffffffff00000000ffffffff00000000ffffffff00000000ffffffff000000001660201c907f00000000ffffffff00000000ffffffff00000000ffffffff00000000ffffffff1660201b17807fffff0000ffff0000ffff0000ffff0000ffff0000ffff0000ffff0000ffff00001660101c907f0000ffff0000ffff0000ffff0000ffff0000ffff0000ffff0000ffff0000ffff1660101b17807fff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff001660081c907f00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff1660081b17606051807fffffffff00000000ffffffff00000000ffffffff00000000ffffffff000000001660201c907f00000000ffffffff00000000ffffffff00000000ffffffff00000000ffffffff1660201b17807fffff0000ffff0000ffff0000ffff0000ffff0000ffff0000ffff0000ffff00001660101c907f0000ffff0000ffff0000ffff0000ffff0000ffff0000ffff0000ffff0000ffff1660101b17807fff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff001660081c907f00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff1660081b17608051807fffffffff00000000ffffffff00000000ffffffff00000000ffffffff000000001660201c907f00000000ffffffff00000000ffffffff00000000ffffffff00000000ffffffff1660201b17807fffff0000ffff0000ffff0000ffff0000ffff0000ffff0000ffff0000ffff00001660101c907f0000ffff0000ffff0000ffff0000ffff0000ffff0000ffff0000ffff0000ffff1660101b17807fff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff001660081c907f00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff1660081b178088166101a05280871660401b6101c05280861660801b6101e052841660c01b610200528087166101205280861660401b6101405280851660801b61016052831660c01b6101805280861660a05280851660401b60c05280841660801b60e052821660c01b6101005280851660205280841660401b60405280831660801b606052811660c01b608052505050507f00000000510e527fade682d100000000000000009b05688c2b3e6c1f000000008160a01b18610300527f000000001f83d9abfb41bd6b00000000000000005be0cd19137e21790000000080197f00000000ffffffffffffffff000000000000000000000000000000000000000016907f0000000000000000000000000000000000000000ffffffffffffffff000000001617610320527f000000003c6ef372fe94f82b0000000000000000a54ff53a5f1d36f1000000006102e0527f000000006a09e667f3bcc9080000000000000000bb67ae8584caa73b000000006102c0526102405161026051610280516102a051610300516102c051610280516102405181601c51604c511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a169283603c51606c511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166102805261030052610240526102c052610320516102e0516102a0516102605181609c5160cc511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a16928360bc5160ec511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166102a05261032052610260526102e0526103305189166102f05189161761034052610340516102e05161029051610240518161011c5161014c511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a16928361013c5161016c511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166102905261034052610240526102e0526102b05189166102705189161761036052610310516102c05161036051610260518161019c516101cc511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a1692836101bc516101ec511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166103605261031052610260526102c05261036051808a166102b0518a16176102b0528816610270518a16176102705261034051806103305288166102f0518a16176102f052610300516102c0516102805161024051816101dc51608c511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a16928361015c5161010c511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166102805261030052610240526102c052610320516102e0516102a051610260518161013c516101ac511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a1692836101fc5160cc511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166102a05261032052610260526102e0526103305189166102f05189161761034052610340516102e051610290516102405181603c51600c511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a16928361019c51604c511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166102905261034052610240526102e0526102b05189166102705189161761036052610310516102c05161036051610260518161017c5160ac511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a16928360fc51606c511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166103605261031052610260526102c05261036051808a166102b0518a16176102b0528816610270518a16176102705261034051806103305288166102f0518a16176102f052610300516102c05161028051610240518161017c5161018c511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a16928361011c51600c511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166102805261030052610240526102c052610320516102e0516102a051610260518160bc516101ec511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a169283605c516101ac511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166102a05261032052610260526102e0526103305189166102f05189161761034052610340516102e05161029051610240518161015c51606c511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a1692836101dc5160cc511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166102905261034052610240526102e0526102b05189166102705189161761036052610310516102c05161036051610260518160fc5161012c511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a169283603c51608c511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166103605261031052610260526102c05261036051808a166102b0518a16176102b0528816610270518a16176102705261034051806103305288166102f0518a16176102f052610300516102c05161028051610240518160fc51606c511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a16928361013c51602c511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166102805261030052610240526102c052610320516102e0516102a05161026051816101bc5161016c511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a16928361019c516101cc511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166102a05261032052610260526102e0526103305189166102f05189161761034052610340516102e051610290516102405181605c5160ac511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a16928360dc5161014c511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166102905261034052610240526102e0526102b05189166102705189161761036052610310516102c051610360516102605181609c516101ec511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a169283601c5161010c511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166103605261031052610260526102c05261036051808a166102b0518a16176102b0528816610270518a16176102705261034051806103305288166102f0518a16176102f052610300516102c05161028051610240518161013c5160ac511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a169283601c5160ec511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166102805261030052610240526102c052610320516102e0516102a0516102605181605c5161014c511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a169283609c516101ec511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166102a05261032052610260526102e0526103305189166102f05189161761034052610340516102e0516102905161024051816101dc5161016c511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a169283603c5161018c511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166102905261034052610240526102e0526102b05189166102705189161761036052610310516102c05161036051610260518160dc51606c511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a16928361011c516101ac511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166103605261031052610260526102c05261036051808a166102b0518a16176102b0528816610270518a16176102705261034051806103305288166102f0518a16176102f052610300516102c051610280516102405181605c5160cc511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a16928361019c5161014c511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166102805261030052610240526102c052610320516102e0516102a0516102605181601c5161010c511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a16928361017c51606c511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166102a05261032052610260526102e0526103305189166102f05189161761034052610340516102e051610290516102405181609c5160ec511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a1692836101bc5160ac511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166102905261034052610240526102e0526102b05189166102705189161761036052610310516102c0516103605161026051816101fc51602c511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a1692836101dc5161012c511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166103605261031052610260526102c05261036051808a166102b0518a16176102b0528816610270518a16176102705261034051806103305288166102f0518a16176102f052610300516102c05161028051610240518161019c51602c511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a16928360bc516101ec511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166102805261030052610240526102c052610320516102e0516102a05161026051816101dc51608c511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a1692836101bc5161014c511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166102a05261032052610260526102e0526103305189166102f05189161761034052610340516102e051610290516102405181601c5160cc511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a16928360fc51606c511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166102905261034052610240526102e0526102b05189166102705189161761036052610310516102c05161036051610260518161013c5161010c511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a169283605c5161016c511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166103605261031052610260526102c05261036051808a166102b0518a16176102b0528816610270518a16176102705261034051806103305288166102f0518a16176102f052610300516102c0516102805161024051816101bc5160ec511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a16928361017c516101cc511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166102805261030052610240526102c052610320516102e0516102a051610260518161019c51606c511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a169283603c5161012c511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166102a05261032052610260526102e0526103305189166102f05189161761034052610340516102e05161029051610240518160bc516101ec511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a169283601c51608c511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166102905261034052610240526102e0526102b05189166102705189161761036052610310516102c05161036051610260518161011c51604c511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a16928360dc5161014c511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166103605261031052610260526102c05261036051808a166102b0518a16176102b0528816610270518a16176102705261034051806103305288166102f0518a16176102f052610300516102c05161028051610240518160dc516101cc511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a1692836101fc5161012c511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166102805261030052610240526102c052610320516102e0516102a051610260518161017c51600c511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a169283607c5161010c511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166102a05261032052610260526102e0526103305189166102f05189161761034052610340516102e05161029051610240518161019c516101ac511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a169283605c5160ec511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166102905261034052610240526102e0526102b05189166102705189161761036052610310516102c051610360516102605181603c5161014c511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a169283609c5160ac511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166103605261031052610260526102c05261036051808a166102b0518a16176102b0528816610270518a16176102705261034051806103305288166102f0518a16176102f052610300516102c05161028051610240518161015c5161010c511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a169283605c51608c511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166102805261030052610240526102c052610320516102e0516102a051610260518160fc51602c511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a16928360dc5160ac511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166102a05261032052610260526102e0526103305189166102f05189161761034052610340516102e0516102905161024051816101fc5161012c511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a16928361017c516101cc511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166102905261034052610240526102e0526102b05189166102705189161761036052610310516102c051610360516102605181607c516101ac511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a16928361019c51600c511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166103605261031052610260526102c05261036051808a166102b0518a16176102b0528816610270518a16176102705261034051806103305288166102f0518a16176102f052610300516102c051610280516102405181601c51604c511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a169283603c51606c511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166102805261030052610240526102c052610320516102e0516102a0516102605181609c5160cc511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a16928360bc5160ec511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166102a05261032052610260526102e0526103305189166102f05189161761034052610340516102e05161029051610240518161011c5161014c511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a16928361013c5161016c511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166102905261034052610240526102e0526102b05189166102705189161761036052610310516102c05161036051610260518161019c516101cc511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a1692836101bc516101ec511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166103605261031052610260526102c05261036051808a166102b0518a16176102b0528816610270518a16176102705261034051806103305288166102f0518a16176102f052610300516102c0516102805161024051816101dc51608c511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a16928361015c5161010c511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166102805261030052610240526102c052610320516102e0516102a051610260518161013c516101ac511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a1692836101fc5160cc511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166102a05261032052610260526102e0526103305189166102f05189161761034052610340516102e051610290516102405181603c51600c511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a16928361019c51604c511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166102905261034052610240526102e0526102b05189166102705189161761036052610310516102c05161036051610260518161017c5160ac511701018a1692831860201c8060401b178a169182018a1690811860181c8060401b178a16928360fc51606c511701018a1691821860101c8060401b178a169081018a1692831860011b8060401c178a166103605261031052610260526102c05261036051808a166102b0518a16176102b0528816610270518a16176102705261034051806103305288166102f0518a16176102f0526102a0511861032051186102a052610280511861030051186102805261026051186102e051186102605261024051186102c051186102405261024051807f00000000ffffffffffffffff00000000000000000000000000000000000000001660201b907f0000000000000000000000000000000000000000ffffffffffffffff000000001660601b1761026051807f00000000ffffffffffffffff00000000000000000000000000000000000000001660601c907f0000000000000000000000000000000000000000ffffffffffffffff000000001660201c1717807fffffffff00000000ffffffff00000000ffffffff00000000ffffffff000000001660201c907f00000000ffffffff00000000ffffffff00000000ffffffff00000000ffffffff1660201b17807fffff0000ffff0000ffff0000ffff0000ffff0000ffff0000ffff0000ffff00001660101c907f0000ffff0000ffff0000ffff0000ffff0000ffff0000ffff0000ffff0000ffff1660101b17807fff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff001660081c907f00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff1660081b1760005261028051807f00000000ffffffffffffffff00000000000000000000000000000000000000001660201b907f0000000000000000000000000000000000000000ffffffffffffffff000000001660601b176102a051807f00000000ffffffffffffffff00000000000000000000000000000000000000001660601c907f0000000000000000000000000000000000000000ffffffffffffffff000000001660201c1717807fffffffff00000000ffffffff00000000ffffffff00000000ffffffff000000001660201c907f00000000ffffffff00000000ffffffff00000000ffffffff00000000ffffffff1660201b17807fffff0000ffff0000ffff0000ffff0000ffff0000ffff0000ffff0000ffff00001660101c907f0000ffff0000ffff0000ffff0000ffff0000ffff0000ffff0000ffff0000ffff1660101b17807fff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff001660081c907f00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff1660081b1760205250505050506000356000f3");

class execution : public evmc_context
{
public:
    execution() noexcept : evmc_context{&interface}, vm{evmc_create_evmone()} {
        tx_context.block_timestamp = 0xdd;
        tx_context.block_coinbase.bytes[1] = 0xcc;
        tx_context.block_number = 0x1100;
        tx_context.block_difficulty.bytes[1] = 0xdd;
        tx_context.block_gas_limit = 7000000;
        tx_context.tx_gas_price.bytes[2] = 0x66;
        tx_context.tx_origin.bytes[2] = 0x55;
    }

    ~execution() noexcept
    {
        // Release the attached EVM execution result.
        if (result.release)
            result.release(&result);
    }

    /// Wrapper for evmone::execute. The result will be in the .result field.
    void execute(int64_t gas, bytes code, std::string_view input_hex = {}) noexcept
    {
        auto input = from_hex(input_hex.data());
        msg.gas = gas;
        msg.input_data = input.data();
        msg.input_size = input.size();
        execute(msg, code);
    }

    void execute(bytes code, std::string_view input_hex = {}) noexcept
    {
        execute(std::numeric_limits<int64_t>::max(), code, input_hex);
    }


    void execute(bytes code, bytes input = {}) noexcept
    {
        msg.gas = std::numeric_limits<int64_t>::max();
        msg.input_data = input.data();
        msg.input_size = input.size();
        execute(msg, code);
    }
    int64_t gas_used = 0;
    evmc_tx_context tx_context;

protected:
    evmc_instance* vm = nullptr;
    evmc_revision rev = EVMC_CONSTANTINOPLE2;  // Use Constantinople by default.
    evmc_message msg = {};
    evmc_result result = {};

    evmc_address last_accessed_account = {};

    std::unordered_map<evmc_bytes32, evmc_bytes32> storage;

    bytes log_data;
    std::vector<evmc_bytes32> log_topics;

    evmc_address selfdestruct_beneficiary = {};

    evmc_bytes32 blockhash = {};

    bool exists = false;
    intx::uint256 balance = {};
    bytes extcode = {};

    evmc_message call_msg = {};
    evmc_result call_result = {};

    static evmc_host_interface interface;

    /// Wrapper for evmone::execute. The result will be in the .result field.
    void execute(const evmc_message& msg, bytes code) noexcept
    {
        // Release previous result.
        if (result.release)
            result.release(&result);

        // auto code = from_hex(code_hex.data());
        result = vm->execute(vm, this, rev, &msg, &code[0], code.size());
        gas_used = msg.gas - result.gas_left;
    }
};

evmc_host_interface execution::interface = {
    [](evmc_context* ctx, const evmc_address* addr) {
        auto& e = *static_cast<execution*>(ctx);
        e.last_accessed_account = *addr;
        return e.exists;
    },
    [](evmc_context* ctx, const evmc_address*, const evmc_bytes32* key) {
        return static_cast<execution*>(ctx)->storage[*key];
    },
    [](evmc_context* ctx, const evmc_address*, const evmc_bytes32* key, const evmc_bytes32* value) {
        auto& storage = static_cast<execution*>(ctx)->storage[*key];

        if (storage == *value)
            return EVMC_STORAGE_UNCHANGED;

        evmc_storage_status status = EVMC_STORAGE_MODIFIED;
        if (is_zero(storage) && !is_zero(*value))
            status = EVMC_STORAGE_ADDED;
        else if (!is_zero(storage) && is_zero(*value))
            status = EVMC_STORAGE_DELETED;
        else if (!is_zero(storage))
            status = EVMC_STORAGE_MODIFIED_AGAIN;

        storage = *value;

        return status;
    },
    [](evmc_context* ctx, const evmc_address* addr) {
        auto& e = *static_cast<execution*>(ctx);
        e.last_accessed_account = *addr;
        evmc_uint256be b = {};
        intx::be::store(b.bytes, e.balance);
        return b;
    },
    [](evmc_context* ctx, const evmc_address* addr) {
        auto& e = *static_cast<execution*>(ctx);
        e.last_accessed_account = *addr;
        return e.extcode.size();
    },
    [](evmc_context* ctx, const evmc_address* addr) {
        auto& e = *static_cast<execution*>(ctx);
        e.last_accessed_account = *addr;
        auto hash = evmc_bytes32{};
        std::fill(std::begin(hash.bytes), std::end(hash.bytes), 0xee);
        return hash;
    },
    [](evmc_context* ctx, const evmc_address* addr, size_t code_offset, uint8_t* buffer_data,
        size_t buffer_size) {
        auto& e = *static_cast<execution*>(ctx);
        e.last_accessed_account = *addr;
        std::copy_n(&e.extcode[code_offset], buffer_size, buffer_data);
        return buffer_size;
    },
    [](evmc_context* ctx, const evmc_address*, const evmc_address* beneficiary) {
        static_cast<execution*>(ctx)->selfdestruct_beneficiary = *beneficiary;
    },
    [](evmc_context* ctx, const evmc_message* msg) {
        auto& e = *static_cast<execution*>(ctx);
        e.call_msg = *msg;
        return e.call_result;
    },
    [](evmc_context* ctx) { return static_cast<execution*>(ctx)->tx_context; },
    [](evmc_context* ctx, int64_t) { return static_cast<execution*>(ctx)->blockhash; },
    [](evmc_context* ctx, const evmc_address*, const uint8_t* data, size_t data_size,
        const evmc_bytes32 topics[], size_t topics_count) {
        auto& e = *static_cast<execution*>(ctx);
        e.log_data.assign(data, data_size);
        e.log_topics.reserve(topics_count);
        std::copy_n(topics, topics_count, std::back_inserter(e.log_topics));
    },
};

execution evm = execution();

// clang-format on

const auto vm = evmc_create_evmone();

// int64_t execute(bytes_view code, bytes_view input) noexcept
// {
//     constexpr auto gas = std::numeric_limits<int64_t>::max();
//     auto msg = evmc_message{};
//     msg.gas = gas;
//     msg.input_data = input.data();
//     msg.input_size = input.size();
//     auto r = vm->execute(vm, nullptr, EVMC_CONSTANTINOPLE, &msg, code.data(), code.size());

//     // FIXME: Fix evmc_release_result() helper.
//     if (r.release)
//         r.release(&r);

//     return gas - r.gas_left;
// }


void empty(State& state) noexcept
{
    for (auto _ : state)
        evm.execute(empty_code, from_hex(""));
}
BENCHMARK(empty);

void sha1_divs(State& state) noexcept
{
    const auto input_size = static_cast<size_t>(state.range(0));

    auto abi_input =
        from_hex("1605782b0000000000000000000000000000000000000000000000000000000000000020");

    auto oss = std::ostringstream{};
    oss << std::hex << std::setfill('0') << std::setw(64) << input_size;
    abi_input += from_hex(oss.str());

    abi_input.resize(abi_input.size() + input_size, 0);

    auto total_gas_used = int64_t{0};
    auto iteration_gas_used = int64_t{0};
    for (auto _ : state)
    {
        evm.execute(sha1_divs_code, abi_input);
        total_gas_used += iteration_gas_used = evm.gas_used;
    }

    state.counters["gas_used"] = Counter(iteration_gas_used);
    state.counters["gas_rate"] = Counter(total_gas_used, Counter::kIsRate);
}
BENCHMARK(sha1_divs)->Arg(0)->Arg(1351)->Arg(2737)->Arg(5311)->Arg(64 * 1024)->Unit(kMicrosecond)->Repetitions(num_repetitions)->ReportAggregatesOnly();


void sha1_shifts(State& state) noexcept
{
    const auto input_size = static_cast<size_t>(state.range(0));
    auto abi_input =
        from_hex("1605782b0000000000000000000000000000000000000000000000000000000000000020");

    auto oss = std::ostringstream{};
    oss << std::hex << std::setfill('0') << std::setw(64) << input_size;
    abi_input += from_hex(oss.str());

    abi_input.resize(abi_input.size() + input_size, 0);

    auto total_gas_used = int64_t{0};
    auto iteration_gas_used = int64_t{0};
    for (auto _ : state)
    {
        evm.execute(sha1_shifts_code, abi_input);
        total_gas_used += iteration_gas_used = evm.gas_used;
    }

    state.counters["gas_used"] = Counter(iteration_gas_used);
    state.counters["gas_rate"] = Counter(total_gas_used, Counter::kIsRate);
}
BENCHMARK(sha1_shifts)->Arg(0)->Arg(1351)->Arg(2737)->Arg(5311)->Arg(64 * 1024)->Unit(kMicrosecond)->Repetitions(num_repetitions)->ReportAggregatesOnly();


void blake2b_shifts(State& state) noexcept
{
    const auto input_size = static_cast<size_t>(state.range(0));
    evm.tx_context.block_gas_limit = 0x29990000;
    auto abi_input = from_hex(
        "d299dac0"
        "0000000000000000000000000000000000000000000000000000000000000060"
        "0000000000000000000000000000000000000000000000000000000000000080"
        "0000000000000000000000000000000000000000000000000000000000000040");

    auto oss = std::ostringstream{};
    oss << std::hex << std::setfill('0') << std::setw(64) << input_size;
    abi_input += from_hex(oss.str());

    abi_input.resize(abi_input.size() + input_size, 0);

    auto total_gas_used = int64_t{0};
    auto iteration_gas_used = int64_t{0};
    for (auto _ : state)
    {
        evm.execute(blake2b_shifts_code, abi_input);
        total_gas_used += iteration_gas_used = evm.gas_used;
    }

    state.counters["gas_used"] = Counter(iteration_gas_used);
    state.counters["gas_rate"] = Counter(total_gas_used, Counter::kIsRate);
}
BENCHMARK(blake2b_shifts)
    ->Arg(0)
    ->Arg(2805)
    ->Arg(5610)
    ->Arg(8415)
    ->Arg(64 * 1024)
    ->Unit(kMicrosecond)->Repetitions(num_repetitions)->ReportAggregatesOnly();

void blake2b_huff(State& state) noexcept
{
    const auto input_size = static_cast<size_t>(state.range(0));
    evm.tx_context.block_gas_limit = 0x29990000;
    auto abi_input = from_hex("0000000000000000000000000000000000000000000000000000000000000040");

    auto oss = std::ostringstream{};
    oss << std::hex << std::setfill('0') << std::setw(64) << input_size;
    abi_input += from_hex(oss.str());

    abi_input.resize(abi_input.size() + input_size, 0);
    // std::cout << abi_input.data() << std::endl;
    auto total_gas_used = int64_t{0};
    auto iteration_gas_used = int64_t{0};
    for (auto _ : state)
    {
        evm.execute(blake2b_huff_code, abi_input);
        total_gas_used += iteration_gas_used = evm.gas_used;
    }

    state.counters["gas_used"] = Counter(iteration_gas_used);
    state.counters["gas_rate"] = Counter(total_gas_used, Counter::kIsRate);
}
BENCHMARK(blake2b_huff)
    ->Arg(0)
    ->Arg(2805)
    ->Arg(5610)
    ->Arg(8415)
    ->Arg(64 * 1024)
    ->Unit(kMicrosecond)->Repetitions(num_repetitions)->ReportAggregatesOnly();


void weierstrudel(State& state) noexcept
{
    const auto input_size = static_cast<size_t>(state.range(0));
    evm.tx_context.block_gas_limit = 7000000;

    auto base_input = from_hex(
        "0000000000000000000000000000000000000000000000000000000000000001"
        "0000000000000000000000000000000000000000000000000000000000000002"
    );
    auto scalar_input = from_hex(
        "ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"
    );
    auto abi_input_base = base_input;
    auto abi_input_scalar = scalar_input;
    for (uint i = 0; i < input_size; i += 1) {
        abi_input_base += base_input;
        abi_input_scalar += scalar_input;
    }
    auto abi_input = abi_input_base + abi_input_scalar;

    auto total_gas_used = int64_t{0};
    auto iteration_gas_used = int64_t{0};
    for (auto _ : state)
    {
        evm.execute(weierstrudel_code, abi_input);
        total_gas_used += iteration_gas_used = evm.gas_used;
    }
    state.counters["gas_used"] = Counter(iteration_gas_used);
    state.counters["gas_rate"] = Counter(total_gas_used, Counter::kIsRate);
}
BENCHMARK(weierstrudel)
    ->Arg(0)
    ->Arg(1)
    ->Arg(2)
    ->Arg(3)
    ->Arg(8)
    ->Arg(9)
    ->Arg(14)
    ->Unit(kMicrosecond)->Repetitions(num_repetitions)->ReportAggregatesOnly();
}  // namespace

BENCHMARK_MAIN();
